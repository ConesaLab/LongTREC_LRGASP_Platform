<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Challenge 3</title>
    <style>
 :root{
            --y-transform-dataset2: 150px;
            --multiply-website-height: 0%;
        }
        /* General Reset and Body */
html, body {
  padding: 0;
  margin: 0;
  font-family: Arial, sans-serif;
  overflow-x: hidden;
  height: calc(100% + var(--multiply-website-height));
  display: flex;
  flex-direction: column;
}

/* Header */
header h1 {
  display: flex;
  align-items: center;
  justify-content: center;
  height: 200px;
  width: 150%;
  background: #ec8551;
  transform: translate(-335px, -24px);
  font-size: 64px;
  color: white;
    text-align: center;
}
header h2, header h3 {
  position: absolute;
  color: white;
  font-size: 20px;
}
header h2 {
  transform: translate(-100px, -10px);
    color: #ec8551;
    font-size: 32px;
    position: absolute;
}
header h3 {
  transform: translate(500px,-80px);
    color: #ec8551;
    font-size: 36px;
    position: absolute;
    text-align: center;
}

/* Lines */
.vertical-line, .horizontal-line {
  position: absolute;
  background-color: #22252a;
}
.vertical-line {
  width: 2px;
  height: calc(80% + var(--multiply-website-height));
  transform: translate(250px, 83px);
    position: absolute;
}
.horizontal-line {
  height: 2px;
  width: 200%;
  transform: translate(-400px, 176px);
    position: absolute;
}

.box-dataset1{
    width: 1100px;
    height: 400px;
    border: 2px dashed black;
    pointer-events: none;
    position: absolute;
    transform: translate(290px, 250px);
}

.box-dataset2 {
  width: 1100px;
  height: 400px;
  border: 2px dashed black; /* Make it obviously visible. */
  pointer-events: none;
  position: absolute;
  transform: translate(52px, calc(75px + var(--y-transform-dataset2)));
}
/* Footer */
footer {
  text-align: center;
  padding: 10px;
  background-color: #333;
  color: white;
}

/* Dropdown & Text Inputs */
.dropdown, .text-input {
  font-size: 14px;
  border-radius: 5px;
  border: 1px solid #000;
}
.dropdown {
  padding: 5px;
  width: 175px;
  color: black;
}
.dropdown::placeholder, .text-input::placeholder {
  color: black;
  opacity: 1;
}
.text-input {
  padding: 4px;
  color: black;
}

/* Container Labels */
.dropdown-container label {
  font-size: 18px;
  color: black;
  transform: translate(0, 3px);
}

/* Specific Container Positioning */
.organism-dropdown-container {
  transform: translate(155px, 10px);
  width: 800px;
}
.tool-name-container {
  transform: translate(600px, -21px);
}
.platform-dropdown-container {
  transform: translate(617px, -4px);
}

#platform-dropdown{
    width: 164px;
}

.library-dropdown-container {
  transform: translate(532px, 10px);
}
#library-dropdown{
    width: 164px;
}

.data-category-container {
  transform: translate(570px, 25px);
}

#data-category-dropdown{
    width: 164px;
}

/* Script Runner */
.script-runner {
  display: flex;
  flex-direction: column;
  align-items: center;
}

/* File Upload Row */
.upload-row, .annotation-container {
  position: absolute;
}
.upload-row {
  display: flex;
  align-items: center;
  gap: 10px;
  transform: translate(80px, -100px);

}

.upload-row-annotation{
    position: absolute;
    border: red 1px solid;
}

.upload-row-reference{
    position: absolute;
}

.upload-row-coverage{
    position: absolute;
}

.file-label {
  font-size: 18px;
  color: #000;
}
.custom-file-upload-transcriptome {
  display: inline-block;
  padding: 3px;
  font-size: 16px;
  background-color: #fff7e9;
  border: 1px solid black;
  color: #353535;
  border-radius: 5px;
  cursor: pointer;
  text-align: center;
}

.custom-file-upload-annotation {
  padding: 3px;
  font-size: 16px;
  background-color: #fff7e9;
  border: 1px solid black;
  color: #353535;
  border-radius: 5px;
  cursor: pointer;
  text-align: center;
  transform: translate(53px,0);
}

.custom-file-upload-reference{
  padding: 3px;
  font-size: 16px;
  background-color: #fff7e9;
  border: 1px solid black;
  color: #353535;
  border-radius: 5px;
  cursor: pointer;
  text-align: center;
  transform: translate(-720px,-41px);
  height: 32px;
position: absolute;
    width: 100px;
}

.custom-file-upload-coverage{
    padding: 3px;
  font-size: 16px;
  background-color: #fff7e9;
  border: 1px solid black;
  color: #353535;
  border-radius: 5px;
  cursor: pointer;
  text-align: center;
  transform: translate(-720px,-39px);
  height: 31px;
  width: 145px;
  position: absolute;
}

#file-name-display{
font-size: 14px;
  padding: 4px;
  background-color: white;
  color: #6c6c6c;
  border: 1px solid black;
  border-radius: 5px;
  width: 175px;
  height: 32px; /* Let height size automatically */
  text-align: left;
}

#annotation-file-name-display{
  font-size: 14px;
  padding: 4px;
  background-color: white;
  color: #6c6c6c;
  border: 1px solid white;
  border-radius: 5px;
  height: 26px; /* Let height size automatically */
  text-align: left;
    transform: translate(-969px, -39px);
    position: absolute;
    width: 125px;
}

#reference-file-name-display{
    font-size: 14px;
  padding: 4px;
  background-color: white;
  color: #6c6c6c;
  border: 1px solid white;
  border-radius: 5px;
  height: 26px; /* Let height size automatically */
  text-align: left;
    transform: translate(-904px, -37px);
    position: absolute;
    width: 125px;
}

#coverage-directory-name-display{
    font-size: 14px;
  padding: 4px;
  background-color: white;
  color: #6c6c6c;
  border: 1px solid white;
  border-radius: 5px;
  height: 26px; /* Let height size automatically */
  text-align: left;
    transform: translate(-904px, -37px);
    position: absolute;
    width: 158px;
}

#annotation-file-name-display-choose-file{
    transform: translate(-790px, -42px);
    position: absolute;
    width: 100px;
}

#add-dataset-button {
  transform: translate(-25px,0);
}

/* Add Dataset */
.add-dataset-container {
  display: flex;
  justify-content: center;
  transform: translate(800px, calc(42px + var(--y-transform-dataset2)));
  position: absolute;

}

.add-dataset {
  background-color: black;
  color: whitesmoke;
  font-size: 14px;
  border: none;
  border-radius: 5px;
  cursor: pointer;
  width: 150px;
  height: 30px;
}
.add-dataset:hover {
  background-color: #4c4c4c;
}

#remove-dataset-button{
   background-color: whitesmoke;
   color: black;
   border: 1px black solid;
   font-size: 14px;
   border-radius: 5px;
   cursor: pointer;
   transform: translate(50px,-20px);
    width: 150px;
    height: 30px;
}

#remove-dataset-button:hover{
    background-color: #d3d3d3;
}

/* Run Script Button */
.script-runner button {
  padding: 5px;
  font-size: 16px;
  background-color: #ec8551;
  border: 1px solid black;
  color: white;
  border-radius: 5px;
  cursor: pointer;
  width: 100px;
  transform: translate(620px, 210px);
}

/* Overlay and Progress */
#overlay {
  display: none;
  position: fixed;
  top: 0; left: 0;
  width: 100%; height: 100%;
  background: rgba(0, 0, 0, 0.8);
  color: white;
  align-items: center;
  justify-content: center;
  z-index: 1000;
}
#progress-container {
  background: white;
  color: black;
  padding: 20px;
  border-radius: 8px;
  text-align: center;
  width: 750px;
}
#progress-bar-container {
  width: 80%;
  background-color: #ddd;
  border-radius: 4px;
  overflow: hidden;
}
#progress-bar {
  width: 0;
  height: 20px;
  background: #4CAF50;
}

/* Annotation Container */
.annotation-container {
  transform: translate(115px, -52px);
    position: absolute;
}

#annotation-upload-row{
    transform: translate(1215px, -12px);
    position: absolute;
}

/* Custom Input Boxes */
#organism-custom-input,
.custom-platform-box,
.custom-lib_prep-box{
  display: none;
  font-size: 14px;
  padding: 5px;
  width: 150px;
  border-radius: 5px;
  border: 1px solid white;
  color: black;
  height: 26px;
  position: absolute;
    transform: translate(-173px,3px);
}

#organism-custom-input:focus{
    outline: none;
}
.custom-platform-box{
  transform: translate(-160px, 3px);
    border-color: white;
    width: 125px;
    height: 26px;
}

.custom-platform-box:focus{
    outline: 0;
}



.custom-lib_prep-box {
  transform: translate(-160px, 3px);
    border-color: white;
    width: 125px;
    height: 26px;
}

.custom-lib_prep-box:focus {
      outline: 0; /* Red outline */
    }

/* Reference Container */
.reference-container {
  transform: translate(50px, -6px);
  width: 400px;

}
#reference-upload-row {
  transform: translate(1150px, 2px);
  display: none;
  width: 225px;
}

/* Coverage Container */
.coverage-container {
  transform: translate(52px, 10px);
  width: 600px;
}
#coverage-upload-row {
  transform: translate(1152px, 18px);
  display: none;
  width: 400px;
}

.cage-container{
  position: absolute;
  transform: translate(115px, 27px);
}

#cage-upload-row {
  position: absolute;
  display: none;
  width: 225px;
}

.custom-file-upload-cage{
    padding: 3px;
  font-size: 16px;
  background-color: #fff7e9;
  border: 1px solid black;
  color: #353535;
  border-radius: 5px;
  cursor: pointer;
  text-align: center;
  height: 31px;
  transform: translate(431px, 27px);
  width: 100px;
  position: absolute;
}

#cage-file-name-display{
    font-size: 14px;
  padding: 4px;
  background-color: white;
  color: #6c6c6c;
  border: 1px solid white;
  border-radius: 5px;
  height: 26px; /* Let height size automatically */
  transform: translate(250px, 30px);
  text-align: left;
    position: absolute;
    width: 158px;
}


#cage-upload-row2 {
  position: absolute;
  display: none;
  width: 225px;
}

.custom-file-upload-cage2{
    padding: 3px;
  font-size: 16px;
  background-color: #fff7e9;
  border: 1px solid black;
  color: #353535;
  border-radius: 5px;
  cursor: pointer;
  text-align: center;
  height: 31px;
  transform: translate(431px, 27px);
  width: 100px;
  position: absolute;
}

#cage-file-name-display2{
    font-size: 14px;
  padding: 4px;
  background-color: white;
  color: #6c6c6c;
  border: 1px solid white;
  border-radius: 5px;
  height: 26px; /* Let height size automatically */
  transform: translate(250px, 30px);
  text-align: left;
    position: absolute;
    width: 158px;
}

.quant-container{
  position: absolute;
  transform: translate(107px, 72px);
}

#quant-upload-row {
  position: absolute;
  display: none;
  width: 225px;
}

.custom-file-upload-quant{
    padding: 3px;
  font-size: 16px;
  background-color: #fff7e9;
  border: 1px solid black;
  color: #353535;
  border-radius: 5px;
  cursor: pointer;
  text-align: center;
  height: 31px;
  transform: translate(431px, 72px);
  width: 100px;
  position: absolute;
}

#quant-file-name-display{
    font-size: 14px;
  padding: 4px;
  background-color: white;
  color: #6c6c6c;
  border: 1px solid white;
  border-radius: 5px;
  height: 26px; /* Let height size automatically */
  transform: translate(250px, 74px);
  text-align: left;
    position: absolute;
    width: 158px;
}

#quant-upload-row2 {
  position: absolute;
  display: none;
  width: 225px;
}

.custom-file-upload-quant2{
    padding: 3px;
  font-size: 16px;
  background-color: #fff7e9;
  border: 1px solid black;
  color: #353535;
  border-radius: 5px;
  cursor: pointer;
  text-align: center;
  height: 31px;
  transform: translate(431px, 72px);
  width: 100px;
  position: absolute;
}

#quant-file-name-display2{
    font-size: 14px;
  padding: 4px;
  background-color: white;
  color: #6c6c6c;
  border: 1px solid white;
  border-radius: 5px;
  height: 26px; /* Let height size automatically */
  transform: translate(250px, 74px);
  text-align: left;
    position: absolute;
    width: 158px;
}

.poly-A-container{
  position: absolute;
  transform: translate(108px, 117px);
}

#poly-A-upload-row {
  position: absolute;
  display: none;
  width: 225px;
}

.custom-file-upload-poly-A{
    padding: 3px;
  font-size: 16px;
  background-color: #fff7e9;
  border: 1px solid black;
  color: #353535;
  border-radius: 5px;
  cursor: pointer;
  text-align: center;
  height: 31px;
  transform: translate(431px, 117px);
  width: 100px;
  position: absolute;
}

#poly-A-file-name-display{
    font-size: 14px;
  padding: 4px;
  background-color: white;
  color: #6c6c6c;
  border: 1px solid white;
  border-radius: 5px;
  height: 26px; /* Let height size automatically */
  transform: translate(250px, 120px);
  text-align: left;
    position: absolute;
    width: 158px;
}

#poly-A-upload-row2 {
  position: absolute;
  display: none;
  width: 225px;
}

.custom-file-upload-poly-A2{
    padding: 3px;
  font-size: 16px;
  background-color: #fff7e9;
  border: 1px solid black;
  color: #353535;
  border-radius: 5px;
  cursor: pointer;
  text-align: center;
  height: 31px;
  transform: translate(431px, 117px);
  width: 100px;
  position: absolute;
}

#poly-A-file-name-display2{
    font-size: 14px;
  padding: 4px;
  background-color: white;
  color: #6c6c6c;
  border: 1px solid white;
  border-radius: 5px;
  height: 26px; /* Let height size automatically */
  transform: translate(250px, 120px);
  text-align: left;
    position: absolute;
    width: 158px;
}

/* Container for the tooltip */
.tooltip-container {
    position: relative;
    display: inline-block;
    cursor: pointer;
}

/* Style for the question mark */
.question-mark {
    background-color: #fff7e9;
    color: black;
    font-weight: bold;
    border-radius: 5px;
    padding: 3px 8px;
    font-size: 14px;
    display: inline-block;
    text-align: center;
    border: black 1px solid;
}

/* Tooltip text (hidden by default) */
.tooltip-text {
    display: none;
    position: absolute;
    background-color: #ec8551;
    color: white;
    padding: 8px;
    border-radius: 5px;
    font-size: 12px;
    width: 200px;
    text-align: center;
    top: 25px;
    left: 50%;
    transform: translateX(-50%);
    box-shadow: 0px 4px 8px rgba(0, 0, 0, 0.2);
}

/* Show tooltip when hovering */
.tooltip-container:hover .tooltip-text {
    display: block;
}


/* ############### FOR SECOND DATASET ################# */
        .platform-row {
  transform: translate(600px, calc(100px + var(--y-transform-dataset2)));
  position: absolute;
}

#platform-dropdown-2 {
  font-size: 14px;
  padding: 5px;
  width: 164px;
  border-radius: 5px;
  border: 1px solid black;
  transform: translate(5px, -5px);
  position: absolute;
}

#platform-custom-input-2 {
  display: none;
  font-size: 14px;
  padding: 5px;
  width: 145px;
  border-radius: 5px;
  border: 0 solid white;
  color: black;
  position: absolute;
  height: 24px;
  transform: translate(8px,0);
}

#platform-custom-input-2:focus{
    outline: none;
}

        .library-dropdown-container-2{
            transform:translate(518px,140px);
            position: absolute;
        }

        #library-dropdown-2{
            font-size: 14px;
            padding: 5px;
            width: 164px;
            border-radius: 5px;
            border: 1px solid black;
            transform: translate(5px,0);
        }

        #library-custom-input-2{
            display: none;
            font-size:14px;
            padding:5px;
            width:140px;
            color:black;
            border: 0 white solid;
            position: absolute;
            height: 24px;
            transform: translate(-155px, 5px);
        }

        #library-custom-input-2:focus{
            outline: none;
        }

        .data-category-row{
            transform: translate(556px, calc(185px + var(--y-transform-dataset2)));
            position: absolute;
        }

        #data-category-dropdown-2{
            font-size: 14px;
            padding: 5px;
            width: 164px;
            border-radius: 5px;
            border: 1px solid black;
            transform: translate(5px,0);
        }


        .upload-row-2{
            transform: translate(59px,calc(98px + var(--y-transform-dataset2)));
            position: absolute;
            display: flex;
        }

        #file-name-display-2{
            font-size: 14px;
            padding: 5px;
            background-color: white;
            color: #6c6c6c;
            border: 1px solid black;
            border-radius: 5px;
            width: 175px;
            position: absolute;
            transform: translate(175px,-3px);
            height: 31px;
        }

        .custom-file-upload-transcriptome-2{
            display: inline-block;
            padding: 3px;
            font-size: 14px;
            background-color: #fff7e9;
            border: 1px solid black;
            color: #353535;
            border-radius: 5px;
            cursor: pointer;
            text-align: center;
            position: absolute;
            transform: translate(355px,-3px);
            height: 31px;
            width: 100px;
        }

        .annotation-container-2{
            position: absolute;
            transform: translate(89px, calc(140px + var(--y-transform-dataset2)));
        }

        #annotation-dropdown-2{
            font-size: 14px;
            padding: 5px;
            width: 175px;
            border: 1px solid black;
            border-radius: 5px;
            position: absolute;
            transform: translate(5px,0);
        }

        #annotation-upload-row-2{
            display: none;
        }

        #annotation-file-name-display-2{
            font-size: 14px;
            padding: 5px;
            background-color: white;
            color: #6c6c6c;
            border: 1px solid white;
            border-radius: 5px;
            width: 150px;
            height: 24px;
            position: absolute;
            transform: translate(158px, 254px);
        }

        #annotation-file-name-display-2:focus{
            outline: none;
        }

        .custom-file-upload-annotation-2{
display: inline-block;
            padding: 3px;
            font-size: 14px;
            background-color: #fff7e9;
            border: 1px solid black;
            color: #353535;
            border-radius: 5px;
            cursor: pointer;
            text-align: center;
            position: absolute;
            transform: translate(334px,255px);
            height: 31px;
            width: 100px;
        }

        .reference-container-2{
            position: absolute;
            transform: translate(95px, calc(185px + var(--y-transform-dataset2)));
            width: 400px;
        }

       #reference-dropdown-2{
            font-size: 14px;
           padding: 5px;
           width: 175px;
           border: 1px solid black;
           border-radius: 5px;
           position: absolute;
           transform: translate(5px,0);
        }

       #reference-upload-row-2{
            display: none;
        }

        #reference-file-name-display-2{
           font-size: 14px;
            padding: 5px;
            background-color: white;
            color: #6c6c6c;
            border: 1px solid white;
            border-radius: 5px;
            width: 150px;
            height: 24px;
            position: absolute;
            transform: translate(158px, 300px);
        }

        .custom-file-upload-reference-2{
            display: inline-block;
            padding: 3px;
            font-size: 14px;
            background-color: #198a82;
            border: 1px solid black;
            color: white;
            border-radius: 5px;
            cursor: pointer;
            text-align: center;
            position: absolute;
            transform: translate(415px,185px);
            height: 31px;
            width: 100px;
        }

        .coverage-container-2{
            position: absolute;
            transform: translate(55px, calc(230px + var(--y-transform-dataset2)));
        }

        #coverage-dropdown-2{
            font-size: 14px;
            padding: 5px;
            width: 175px;
            border: 1px solid black;
            border-radius: 5px;
            transform: translate(5px, 0);
            height: 31px;
        }

        #coverage-upload-row-2{
            display: none;
        }

        #coverage-directory-name-display-2{
            font-size: 13px;
            padding: 5px;
            background-color: white;
            color: #6c6c6c;
            border: 0 solid white;
            border-radius: 5px;
            width: 150px;
            position: absolute;
            transform: translate(160px, 345px);
            height: 24px;
        }

        .custom-file-upload-coverage-2{
            display: inline-block;
            padding: 3px;
            font-size: 14px;
            background-color: #fff7e9;
            border: 1px solid black;
            color: #353535;
            border-radius: 5px;
            cursor: pointer;
            text-align: center;
            position: absolute;
            transform: translate(334px,345px);
            height: 31px;
            width: 125px;
        }

        /* Custom file upload button */
.custom-file-upload {
  padding: 8px 12px;
  font-size: 14px;
  color: white;
  background-color: #ec8551;
  border: none;
  border-radius: 5px;
  cursor: pointer;
}

.custom-file-upload:hover {
  background-color: #177e76;
}

/* Style for file name display */
.file-name {
  margin-top: 5px;
  font-size: 14px;
  color: #6c6c6c;
  padding: 5px;
  background-color: #f9f9f9;
  border: 1px solid #ccc;
  border-radius: 5px;
  width: 250px;
}

.sirvs-checkboxes{
    position: absolute;
    transform: translate(910px,-215px);
}



/* Toggle Switch Styling */
.toggle-switch {
    position: relative;
    display: inline-block;
    width: 50px;
    height: 25px;
}

.toggle-switch input {
    display: none;
}

.slider {
    position: absolute;
    cursor: pointer;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-color: #ccc;
    border-radius: 25px;
    transition: 0.4s;
}

.slider:before {
    position: absolute;
    content: "";
    height: 19px;
    width: 19px;
    left: 3px;
    bottom: 3px;
    background-color: white;
    border-radius: 50%;
    transition: 0.4s;
}

input:checked + .slider {
    background-color: #4CAF50;
}

input:checked + .slider:before {
    transform: translateX(25px);
}

.comparison {
  transform: translate(-450px, 150px);
  display: none; /* Hidden by default */
    position: absolute;
}

#comparison-dropdown {
  font-size: 16px;
  padding: 5px;
  background-color: white;
  color: #6c6c6c;
  border: 1px solid black;
  border-radius: 5px;
  width: 250px;
  height: auto; /* Adjust height for multiple selections */
  text-align: left;
}

/* Style for the Choices.js dropdown */
.choices {
  width: 250px;
    transform: translate(100px,-35px);
}

.choices__list--dropdown {
  max-height: 200px; /* Add scrolling if there are many options */
  overflow-y: auto;
}

.remove-btn {
    font-size: 16px;  /* Change this value */
    font-weight: bold;
    color: red;
    cursor: pointer;

}

/* Change background color of selected chips */
.choices__list--multiple .choices__item {
    background-color: #ec8551 !important; /* Replace with your desired color */
    color: white !important; /* Change text color for contrast */
    border-radius: 10px; /* Optional: Make it rounded */
    padding: 5px 10px; /* Optional: Adjust padding */
}

/* If you want a hover effect */
.choices__list--multiple .choices__item:hover {
    background-color: #177e76 !important; /* Slightly darker shade */
}

.sirv-checkbox-container {
    display: flex;
    align-items: center;
    position: absolute;
}

#sirv-file-container{
    transform: translate(125px,25px);
    position: absolute;
}

.custom-file-upload_sirv{
    display: inline-block;
            padding: 3px;
            font-size: 12px;
            background-color: #ec8551;
            border: 1px solid black;
            color: white;
            border-radius: 5px;
            cursor: pointer;
            text-align: center;
            position: absolute;
            height: 31px;
            width: 100px;
    line-height: 25px;
}

#sirv-file-name{
    transform: translate(-125px, -5px);
    position: absolute;
    height: 32px;
    width: 120px;
}

.ercc-checkbox-container {
    transform: translate(0, 65px);
    display: flex;
    align-items: center;
    position: absolute;
}

.custom-file-upload_ercc{
    display: inline-block;
            padding: 3px;
            font-size: 12px;
            background-color: #ec8551;
            border: 1px solid black;
            color: white;
            border-radius: 5px;
            cursor: pointer;
            text-align: center;
            position: absolute;
            height: 31px;
            width: 100px;
    line-height: 25px;
    transform: translate(125px, 90px);
}

#ercc-file-name{
    transform: translate(0, 85px);
    position: absolute;
    height: 32px;
    width: 120px;
}

.sequin-checkbox-container {
    transform: translate(0, 130px);
    display: flex;
    align-items: center;
    position: absolute;
}

.custom-file-upload_sequin{
    display: inline-block;
            padding: 3px;
            font-size: 12px;
            background-color: #ec8551;
            border: 1px solid black;
            color: white;
            border-radius: 5px;
            cursor: pointer;
            text-align: center;
            position: absolute;
            height: 31px;
            width: 100px;
    line-height: 25px;
    transform: translate(125px, 155px);
}

#sequin-file-name{
    transform: translate(0, 150px);
    position: absolute;
    height: 32px;
    width: 120px;
}

/* Hide file containers by default */
.sirv-file-container,
.ercc-file-container,
.sequin-file-container {
  display: none;
}

/* When the checkbox is checked, display its adjacent file container */
.sirv-checkbox:checked ~ .sirv-file-container,
.ercc-checkbox:checked ~ .ercc-file-container,
.sequin-checkbox:checked ~ .sequin-file-container {
  display: block;
}


.sirvs-container-2{
    position: absolute;
    transform: translate(900px, calc(100px + var(--y-transform-dataset2)));
}

.sirv-group-sirv{
    position: absolute;
}

#sirv-2-file-upload {
  display: none;
}

.custom-file-upload_sirv2{
    display: inline-block;
            padding: 3px;
            font-size: 12px;
            background-color: #ec8551;
            border: 1px solid black;
            color: white;
            border-radius: 5px;
            cursor: pointer;
            text-align: center;
            position: absolute;
            height: 31px;
            width: 100px;
    line-height: 25px;
    transform: translate(125px,0);
}

.file-name-sirv2 {
    font-size: 14px;
    padding: 5px;
    background-color: #f8f8f8;
    color: #6c6c6c;
    border: 1px solid #c4c4c4;
    border-radius: 5px;
    width: 120px;
    height: 31px;
    position: absolute;
    text-align: center;
    line-height: 22px;
    align-items: center;
}

.sirv-group-ercc{
    position: absolute;
    transform: translate(0, 60px);
}

#ercc-2-file-upload {
  display: none;
}

.custom-file-upload_ercc2{
    display: inline-block;
            padding: 3px;
            font-size: 12px;
            background-color: #ec8551;
            border: 1px solid black;
            color: white;
            border-radius: 5px;
            cursor: pointer;
            text-align: center;
            position: absolute;
            height: 31px;
            width: 100px;
    line-height: 25px;
    transform: translate(125px,0);
}

.file-name-ercc2{
    font-size: 14px;
    padding: 5px;
    background-color: #f8f8f8;
    color: #6c6c6c;
    border: 1px solid #c4c4c4;
    border-radius: 5px;
    width: 120px;
    height: 31px;
    position: absolute;
    text-align: center;
    line-height: 22px;
    align-items: center;
}

.sirv-group-sequin{
    position: absolute;
    transform: translate(0, 120px);
}

#sequin-2-file-upload {
  display: none;
}

.custom-file-upload_sequin2{
    display: inline-block;
            padding: 3px;
            font-size: 12px;
            background-color: #ec8551;
            border: 1px solid black;
            color: white;
            border-radius: 5px;
            cursor: pointer;
            text-align: center;
            position: absolute;
            height: 31px;
            width: 100px;
    line-height: 25px;
    transform: translate(125px,0);
}

.file-name-sequin2{
    font-size: 14px;
    padding: 5px;
    background-color: #f8f8f8;
    color: #6c6c6c;
    border: 1px solid #c4c4c4;
    border-radius: 5px;
    width: 120px;
    height: 31px;
    position: absolute;
    text-align: center;
    line-height: 22px;
    align-items: center;
}

#terminal-log-container{
     width:80%;
    height:200px;
    background-color:black;
    color: limegreen;
    border: black 1px solid;
    overflow-y:scroll;
    padding:10px;
    border-radius: 15px;
    text-align: left;
}
    </style>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/choices.js/public/assets/styles/choices.min.css" />
<script src="https://cdn.jsdelivr.net/npm/choices.js/public/assets/scripts/choices.min.js"></script>




</head>

<body>
{% extends "base.html" %}
{% block content %}
<div class="vertical-line"></div>
<div class="horizontal-line"></div>
<div class="box-dataset1"></div>

<header>
  <h1>Full-Length Transcript Reconstruction</h1>
    <h2 style="text-align: center; transform: translate(-175px,0); font-size: 24px;">Is your data derived from <br> a LRGASP dataset?</h2>
    <div style="transform: translate(-75px, 100px);">
        <label class="toggle-switch">
        <input type="checkbox" id="toggleSwitchLRGASP">
        <span class="slider"></span>
    </label>
    </div>
    <h2 style="text-align: center; transform: translate(-200px,200px); font-size: 24px;">Do you want to compare your results <br> with LRGASP results?</h2>
    <div style="transform: translate(-75px, 300px);">
        <!-- Toggle Switch -->
    <label class="toggle-switch">
        <input type="checkbox" id="toggleSwitchComparison">
        <span class="slider"></span>
    </label>
    </div>
    <h3> Run LRGASP Benchmarking On Your Data</h3>
</header>

<main class="main-container">
  <!-- Form to upload file and run the script -->
  <div class="script-runner">
        <form id="script-form" action="{{ url_for('run_script_challenge1') }}" method="POST" enctype="multipart/form-data">

      <!-- Organism Dropdown -->
      <div class="dropdown-container organism-dropdown-container">
        <label for="organism-dropdown">Organism: </label>
        <select id="organism-dropdown" class="dropdown" name="organism" required>
          <option value="initial" disabled selected>Choose organism...</option>
          <option value="mouse">Mouse</option>
          <option value="human">Human</option>
          <option value="custom">Custom</option>
        </select>
        <!-- Hidden text input for custom organism -->
        <input type="text" id="organism-custom-input" name="organism_custom" placeholder="Please type...">
      </div>

        <!-- Tool Name Input Box -->
      <div class="dropdown-container tool-name-container">
        <label for="tool-input">Tool Name: </label>
        <input type="text" id="tool-input" class="text-input" name="tool" placeholder=" your_tool">
      </div>

      <!-- Platform Dropdown -->
<div class="dropdown-container platform-dropdown-container">
    <label for="platform-dropdown">Platform: </label>
    <select id="platform-dropdown" class="dropdown" name="platform" required>
        <option value="PacBio" selected>PacBio</option>
        <option value="ONT">Oxford Nanopore Technologies</option>
        <option value="custom">Custom</option>
    </select>
    <!-- Hidden text input for custom platform -->
    <input class="custom-platform-box" type="text" id="platform-custom-input" name="platform_custom" placeholder="Enter Platform..." style="display: none;">
</div>

<!-- Library Preparation Dropdown -->
<div class="dropdown-container library-dropdown-container">
    <label for="library-dropdown">Library Preparation: </label>
    <select id="library-dropdown" class="dropdown" name="library_preparation" required>
        <option value="cDNA" selected>cDNA</option>
        <option value="directRNA">directRNA</option>
        <option value="R2C2">R2C2</option>
        <option value="CapTrap">CapTrap</option>
        <option value="custom">Custom</option>
    </select>
    <!-- Hidden text input for custom library preparation -->
    <input class="custom-lib_prep-box" type="text" id="library-custom-input" name="library_custom" placeholder="Please type..." style="display: none;">
</div>

      <!-- Data Category Dropdown -->
      <div class="dropdown-container data-category-container">
        <label for="data-category-dropdown">Data Category: </label>
        <select id="data-category-dropdown" class="dropdown" name="data_category" required>
          <option value="NA" selected>NA</option>
          <option value="LS">LS</option>
          <option value="SO">SO</option>
          <option value="LO">LO</option>
        </select>
      </div>

      <!-- Transcriptome File -->
      <div class="upload-row">
        <span class="file-label">Transcriptome File:</span>
        <div id="file-name-display">&nbsp;No file chosen...</div>
        <label for="file-upload" class="custom-file-upload-transcriptome">Choose File </label>
        <input type="file" id="file-upload" name="file" onchange="displayFileName()" hidden required>
        <button type="button" onclick="start_progress(event)">Run Script</button>
      </div>

      <!-- Annotation File -->
<div class="dropdown-container annotation-container">
  <label for="annotation-dropdown">Annotation File: </label>
  <select id="annotation-dropdown" class="dropdown" name="annotation" onchange="toggleAnnotationInput()">
    <option value="LRGASP_DATA" selected>LRGASP Data</option>
    <option value="custom">Custom</option>
  </select>
</div>

<!-- Annotation File Upload Row -->
<div class="upload-row-annotation" id="annotation-upload-row" style="display: none;">
  <div id="annotation-file-name-display" class="click-through">&nbsp;No file chosen...</div>
  <label for="annotation-upload" class="custom-file-upload-annotation" id="annotation-file-name-display-choose-file">Choose File</label>
  <input type="file" id="annotation-upload" name="annotation_file" onchange="displayAnnotationFileName()" hidden>
</div>

<!-- Reference File -->
      <div class="dropdown-container reference-container">
        <label for="reference-dropdown">Reference Genome File: </label>
        <select id="reference-dropdown" class="dropdown" name="reference" onchange="toggleReferenceInput()">
          <option value="LRGASP_DATA" selected>LRGASP Data</option>
          <option value="custom">Custom</option>
        </select>
      </div>

      <!-- Reference File Upload Row -->
      <div class="upload-row-reference" id="reference-upload-row">
        <div id="reference-file-name-display">&nbsp;No file chosen...</div>
        <label for="reference-upload" class="custom-file-upload-reference">Choose File</label>
        <input type="file" id="reference-upload" name="reference_file" onchange="displayReferenceFileName()" hidden>
      </div>

            <!-- Coverage Directory -->
<div class="dropdown-container coverage-container">
        <!-- Container for the question mark and tooltip -->
<div class="tooltip-container">
    <span class="question-mark">?</span>
    <div class="tooltip-text">Provide the directory containing the short-read Splice Junctions .out.tab files generated using Illumina. Even if you only have a single sample, it must be in its own directory.</div>
</div>
    <label for="coverage-dropdown">Coverage Directory: </label>
    <select id="coverage-dropdown" class="dropdown" name="coverage_directory" onchange="toggleCoverageInput()">
        <option value="NA">None</option>
        <option value="LRGASP_DATA" selected>LRGASP Data</option>
        <option value="custom">Custom</option>
    </select>


</div>

<!-- Coverage Directory Upload Row -->
<div class="upload-row-coverage" id="coverage-upload-row" style="display: none;">
    <div id="coverage-directory-name-display">&nbsp;No directory chosen...</div>
    <label for="coverage-upload" class="custom-file-upload-coverage">Choose Directory</label>
    <input type="file" id="coverage-upload" name="coverage_directory[]" webkitdirectory multiple onchange="displayCoverageDirectoryName()" hidden>
</div>

            <!-- CAGE Peak File -->
<div class="dropdown-container cage-container">
        <!-- Container for the question mark and tooltip -->
    <label for="cage-dropdown">CAGE Peak File: </label>
    <select id="cage-dropdown" class="dropdown" name="cage-file" onchange="toggleCageInput()">
        <option value="reference">Reference</option>
        <option value="LRGASP_DATA" selected>LRGASP Data</option>
        <option value="custom">Custom</option>
    </select>
</div>

<div class="upload-row-cage" id="cage-upload-row" style="display: none;">
    <div id="cage-file-name-display">&nbsp;No file chosen...</div>
    <label for="cage-upload" class="custom-file-upload-cage">Choose File</label>
    <input type="file" id="cage-upload" name="cage_file" onchange="displayCageFileName()" hidden>
</div>

            <!-- Quant-Seq File -->
<div class="dropdown-container quant-container">
        <!-- Container for the question mark and tooltip -->
    <label for="quant-dropdown">QUANT-seq File: </label>
    <select id="quant-dropdown" class="dropdown" name="quant-file" onchange="toggleQuantInput()">
        <option value="reference">Reference</option>
        <option value="LRGASP_DATA" selected>LRGASP Data</option>
        <option value="custom">Custom</option>
    </select>
</div>

<div class="upload-row-quant" id="quant-upload-row" style="display: none;">
    <div id="quant-file-name-display">&nbsp;No file chosen...</div>
    <label for="quant-upload" class="custom-file-upload-quant">Choose File</label>
    <input type="file" id="quant-upload" name="cage_file" onchange="displayQuantFileName()" hidden>
</div>

            <!-- Poly A Motif -->
<div class="dropdown-container poly-A-container">
        <!-- Container for the question mark and tooltip -->
    <label for="poly-A-dropdown">Poly A Motif File: </label>
    <select id="poly-A-dropdown" class="dropdown" name="poly-A-file" onchange="togglePolyAInput()">
        <option value="NA">None</option>
        <option value="LRGASP_DATA" selected>LRGASP Data</option>
        <option value="custom">Custom</option>
    </select>
</div>

<div class="upload-row-poly-A" id="poly-A-upload-row" style="display: none;">
    <div id="poly-A-file-name-display">&nbsp;No file chosen...</div>
    <label for="poly-A-upload" class="custom-file-upload-poly-A">Choose File</label>
    <input type="file" id="poly-A-upload" name="poly_A_file" onchange="displayPolyAFileName()" hidden>
</div>

            <div class="comparison">
                <label>Comparison</label>
                <select id="comparison-dropdown" name="comparison-dropdown" multiple>
                    <option name="comparison_option_bambu" value="Bambu"> Bambu</option>
                    <option name="comparison_option_FLAIR" value="FLAIR"> FLAIR</option>
                    <option name="comparison_option_Lyric" value="Lyric"> Lyric*</option>
                    <option name="comparison_option_IsoTools" value="IsoTools"> IsoTools</option>
                    <option name="comparison_option_Mandalorion" value="Mandalorion"> Mandalorion</option>
                    <option name="comparison_option_Iso_IB" value="Iso_IB"> Iso_IB</option>
                    <option name="comparison_option_FLAMES" value="FLAMES"> FLAMES</option>
                    <option name="comparison_option_IsoQuant" value="IsoQuant"> IsoQuant</option>
                    <option name="comparison_option_Spectra" value="Spectra"> Spectra</option>
                    <option name="comparison_option_TALON_LAPA" value="TALON_LAPA"> TALON_LAPA</option>
                    <option name="comparison_option_StringTie2" value="StringTie2"> StringTie2</option>
                </select>
            </div>

<div class="sirvs-checkboxes">
  <label>Select the SIRV types present:</label>
  <div>
    <!-- SIRV -->
      <div class="sirv-checkbox-container">
        <label>
            <input type="checkbox" id="sirv-checkbox" value="SIRV" onclick="toggleFileInput('sirv')"> SIRV
        </label>
    </div>

    <div id="sirv-file-container" style="display: none;">
      <label for="sirv-file-upload" class="custom-file-upload_sirv">Choose SIRV</label>
      <input type="file" id="sirv-file-upload" name="sirv_file" onchange="displayFileNameSIRVs('sirv')" hidden>
      <div id="sirv-file-name" class="file-name">No file chosen...</div>
    </div>


    <!-- ERCC -->
    <div class="ercc-checkbox-container">
        <label>
            <input type="checkbox" id="ercc-checkbox" value="ERCC" onclick="toggleFileInput('ercc')"> ERCC
        </label>
    </div>

    <div id="ercc-file-container" style="display: none;">
      <label for="ercc-file-upload" class="custom-file-upload_ercc">Choose ERCC</label>
      <input type="file" id="ercc-file-upload" name="ercc_file" onchange="displayFileNameSIRVs('ercc')" hidden>
      <div id="ercc-file-name" class="file-name">No file chosen...</div>
    </div>

    <!-- SEQUIN -->
      <div class="sequin-checkbox-container">
        <label>
            <input type="checkbox" id="sequin-checkbox" value="SEQUIN" onclick="toggleFileInput('sequin')"> SEQUIN
        </label>
    </div>

    <div id="sequin-file-container" style="display: none;">
      <label for="sequin-file-upload" class="custom-file-upload_sequin">Choose SEQUIN</label>
      <input type="file" id="sequin-file-upload" name="sequin_file" onchange="displayFileNameSIRVs('sequin')" hidden>
      <div id="sequin-file-name" class="file-name">No file chosen...</div>
    </div>
  </div>
</div>

        <!-- New boxes will be appended here -->
<div id="additional-datasets-container"></div>
    </form>
  </div>

  <!-- Add dataset button -->
<div class="add-dataset-container">
  <button id="add-dataset-button" class="add-dataset">+ Add Dataset</button>
  <button id="remove-dataset-button" class="remove-dataset" style="display: none; position: absolute">- Remove Dataset</button>
</div>

<!-- Hidden static HTML for Dataset 2 SIRVs -->
<div id="dataset2-sirv-section" style="display: none;">

    <!-- Transcriptome File -->
      <div class="upload-row-2">
        <span class="file-label-2">Transcriptome File 2:</span>
        <div id="file-name-display-2">&nbsp;No file chosen...</div>
        <label for="file-upload-2" class="custom-file-upload-transcriptome-2">Choose File </label>
        <input type="file" id="file-upload-2" name="file-2" onchange="displayFileName2()" hidden required>
      </div>

     <!-- Annotation File -->
<div class="dropdown-container annotation-container-2">
  <label for="annotation-dropdown-2">Annotation File 2: </label>
  <select id="annotation-dropdown-2" class="dropdown-2" name="annotation-2" onchange="toggleAnnotationInput2()">
    <option value="default">LRGASP Data</option>
    <option value="custom">Custom</option>
    <option value="NA" selected>None</option>
  </select>
</div>

<!-- Annotation File Upload Row -->
<div class="upload-row-annotation-2" id="annotation-upload-row-2" style="display: none;">
  <div id="annotation-file-name-display-2" class="click-through">&nbsp;No file chosen...</div>
  <label for="annotation-upload-2" class="custom-file-upload-annotation-2" id="annotation-file-name-display-choose-file-2">Choose File</label>
  <input type="file" id="annotation-upload-2" name="annotation_file-2" onchange="displayAnnotationFileName2()" hidden>
</div>

    <!-- Reference File -->
      <div class="dropdown-container reference-container-2">
        <label for="reference-dropdown-2">Reference Genome File 2: </label>
        <select id="reference-dropdown-2" class="dropdown-2" name="reference-2" onchange="toggleReferenceInput2()">
          <option value="default" selected>LRGASP Data</option>
          <option value="custom">Custom</option>
        </select>
      </div>

      <!-- Reference File Upload Row -->
      <div class="upload-row-reference-2" id="reference-upload-row-2" style="display: none;">
        <div id="reference-file-name-display-2">&nbsp;No file chosen...</div>
        <label for="reference-upload-2" class="custom-file-upload-reference-2">Choose File</label>
        <input type="file" id="reference-upload-2" name="reference_file-2" onchange="displayReferenceFileName2()" hidden>
      </div>

               <!-- Coverage Directory -->
<div class="dropdown-container coverage-container-2">
        <!-- Container for the question mark and tooltip -->
<div class="tooltip-container">
    <span class="question-mark">?</span>
    <div class="tooltip-text">Provide the directory containing the short-read Splice Junctions .out.tab files generated using Illumina. Even if you only have a single sample, it must be in its own directory.</div>
</div>
    <label for="coverage-dropdown-2">Coverage Directory 2: </label>
    <select id="coverage-dropdown-2" class="dropdown-2" name="coverage_directory-2" onchange="toggleCoverageInput2()">
        <option value="default" selected>LRGASP Data</option>
        <option value="custom">Custom</option>
        <option value="none">None</option>
    </select>


</div>

<!-- Coverage Directory Upload Row -->
<div class="upload-row-coverage-2" id="coverage-upload-row-2" style="display: none;">
    <div id="coverage-directory-name-display-2">&nbsp;No directory chosen...</div>
    <label for="coverage-upload-2" class="custom-file-upload-coverage-2">Choose Directory</label>
    <input type="file" id="coverage-upload-2" name="coverage_directory_2[]" webkitdirectory multiple onchange="displayCoverageDirectoryName2()" hidden>
</div>

          <!-- Platform Dropdown -->
<div class="dropdown-container platform-dropdown-container-2">
    <label for="platform-dropdown-2">Platform: </label>
    <select id="platform-dropdown-2" class="dropdown-2" name="platform-2" required>
        <option value="PacBio" selected>PacBio</option>
        <option value="ONT">Oxford Nanopore Technologies</option>
        <option value="custom">Custom</option>
    </select>
    <!-- Hidden text input for custom platform -->
    <input class="custom-platform-box-2" type="text" id="platform-custom-input-2" name="platform_custom-2" placeholder="Enter Platform..." style="display: none;">
</div>

    <!-- Library Preparation Dropdown -->
<div class="dropdown-container library-dropdown-container-2">
    <label for="library-dropdown-2">Library Preparation: </label>
    <select id="library-dropdown-2" class="dropdown-2" name="library_preparation-2" required>
        <option value="cDNA" selected>cDNA</option>
        <option value="dRNA">directRNA</option>
        <option value="R2C2">R2C2</option>
        <option value="CapTrap">CapTrap</option>
        <option value="custom">Custom</option>
    </select>
    <!-- Hidden text input for custom library preparation -->
    <input class="custom-lib_prep-box-2" type="text" id="library-custom-input-2" name="library_custom-2" placeholder="Please type..." style="display: none;">
</div>

    <!-- Data Category Dropdown -->
      <div class="dropdown-container data-category-container-2">
        <label for="data-category-dropdown-2">Data Category: </label>
        <select id="data-category-dropdown-2" class="dropdown-2" name="data_category-2" required>
          <option value="NA" selected>NA</option>
          <option value="LS">LS</option>
          <option value="SO">SO</option>
          <option value="LO">LO</option>
        </select>
      </div>

               <!-- CAGE Peak File -->
<div class="dropdown-container cage-container2">
        <!-- Container for the question mark and tooltip -->
    <label for="cage-dropdown">CAGE Peak File: </label>
    <select id="cage-dropdown2" class="dropdown" name="cage-file2" onchange="toggleCageInput2()">
        <option value="reference">Reference</option>
        <option value="LRGASP_DATA" selected>LRGASP Data</option>
        <option value="custom">Custom</option>
    </select>
</div>

<div class="upload-row-cage2" id="cage-upload-row2" style="display: none;">
    <div id="cage-file-name-display2">&nbsp;No file chosen...</div>
    <label for="cage-upload2" class="custom-file-upload-cage2">Choose File</label>
    <input type="file" id="cage-upload2" name="cage_file2" onchange="displayCageFileName2()" hidden>
</div>

            <!-- Quant-Seq File -->
<div class="dropdown-container quant-container2">
        <!-- Container for the question mark and tooltip -->
    <label for="quant-dropdown2">QUANT-seq File: </label>
    <select id="quant-dropdown2" class="dropdown" name="quant-file2" onchange="toggleQuantInput2()">
        <option value="reference">Reference</option>
        <option value="LRGASP_DATA" selected>LRGASP Data</option>
        <option value="custom">Custom</option>
    </select>
</div>

<div class="upload-row-quant2" id="quant-upload-row2" style="display: none;">
    <div id="quant-file-name-display2">&nbsp;No file chosen...</div>
    <label for="quant-upload2" class="custom-file-upload-quant2">Choose File</label>
    <input type="file" id="quant-upload2" name="quant-file2" onchange="displayQuantFileName2()" hidden>
</div>

            <!-- Poly A Motif -->
<div class="dropdown-container poly-A-container2">
        <!-- Container for the question mark and tooltip -->
    <label for="poly-A-dropdown2">Poly A Motif File: </label>
    <select id="poly-A-dropdown2" class="dropdown" name="poly-A-file2" onchange="togglePolyAInput2()">
        <option value="NA">None</option>
        <option value="LRGASP_DATA" selected>LRGASP Data</option>
        <option value="custom">Custom</option>
    </select>
</div>

<div class="upload-row-poly-A2" id="poly-A-upload-row2" style="display: none;">
    <div id="poly-A-file-name-display2">&nbsp;No file chosen...</div>
    <label for="poly-A-upload2" class="custom-file-upload-poly-A2">Choose File</label>
    <input type="file" id="poly-A-upload2" name="poly_A_file2" onchange="displayPolyAFileName2()" hidden>
</div>

  <div class="sirvs-container-2">
      <label>Select the SIRV types present:</label>
    <div class="sirv-group-sirv">
      <input type="checkbox" id="sirv-2-checkbox" class="sirv-checkbox" />
      <label for="sirv-2-checkbox">&nbsp;SIRV</label>
      <div class="sirv-file-container">
        <label for="sirv-2-file-upload" class="custom-file-upload_sirv2">Choose SIRV</label>
        <input type="file" id="sirv-2-file-upload" name="sirv_file_2" />
        <div class="file-name-sirv2">No file chosen...</div>
      </div>
    </div>
    <div class="sirv-group-ercc">
      <input type="checkbox" id="ercc-2-checkbox" class="ercc-checkbox" />
      <label for="ercc-2-checkbox">&nbsp;ERCC</label>
      <div class="ercc-file-container">
        <label for="ercc-2-file-upload" class="custom-file-upload_ercc2">Choose ERCC</label>
        <input type="file" id="ercc-2-file-upload" name="ercc_file_2" />
        <div class="file-name-ercc2">No file chosen...</div>
      </div>
    </div>
    <div class="sirv-group-sequin">
      <input type="checkbox" id="sequin-2-checkbox" class="sequin-checkbox" />
      <label for="sequin-2-checkbox">&nbsp;SEQUIN</label>
      <div class="sequin-file-container">
        <label for="sequin-2-file-upload" class="custom-file-upload_sequin2">Choose SEQUIN</label>
        <input type="file" id="sequin-2-file-upload" name="sequin_file_2" />
        <div class="file-name-sequin2">No file chosen...</div>
      </div>
    </div>
  </div>
</div>



  <!-- Overlay (Hidden by Default) -->
  <div id="overlay">
      <div id="progress-container">
          <h2 id="status-message">Booting Script...</h2>
          <div id="progress-bar-container">
              <div id="progress-bar"></div>
          </div>
          <div id="terminal-log-container">
            <p>Terminal logs will appear here...</p>
          </div>
      </div>
  </div>
</main>


<script>
// Select the toggle switch and the dropdown menu
const toggleSwitch = document.getElementById("toggleSwitchComparison");
const comparison_dropdown = document.querySelector(".comparison");

// Add an event listener to the toggle switch
toggleSwitch.addEventListener("change", function () {
    if (toggleSwitch.checked) {
        // Show the dropdown when toggle is ON (Yes)
        comparison_dropdown.style.display = "flex";
    } else {
        // Hide the dropdown when toggle is OFF (No)
        comparison_dropdown.style.display = "none";
    }
});

    // Initialize Choices.js with the option to remove selected items
document.addEventListener('DOMContentLoaded', function () {

    const comparisonDropdown = new Choices('#comparison-dropdown', {
        removeItems: true,
        removeItemButton: true,
        searchEnabled: true,
        placeholderValue: 'Select options',
        shouldSort: false,
        itemSelectText: ''
    });

    // Function to add 'X' buttons to selected items only
    function addRemoveButtons() {
        document.querySelectorAll('.choices__list--multiple .choices__item').forEach(item => {
            if (!item.querySelector('.remove-btn')) {
                let removeButton = document.createElement('span');
                removeButton.classList.add('remove-btn');
                removeButton.innerHTML = 'x';
                removeButton.style.cursor = 'pointer';

                removeButton.addEventListener('click', function () {
                    const valueToRemove = item.getAttribute('data-value');
                    comparisonDropdown.removeActiveItemsByValue(valueToRemove);
                });

                item.appendChild(removeButton);
            }
        });
    }

    // Watch for changes in the selection and add buttons
    document.querySelector('#comparison-dropdown').addEventListener('change', function () {
        setTimeout(addRemoveButtons, 10); // Delay to allow Choices.js to render items
    });

});


// Toggle the visibility of the comparison dropdown based on the toggle switch
const toggleSwitchComparison = document.getElementById("toggleSwitchComparison");
const comparisonContainer = document.querySelector(".comparison");

toggleSwitchComparison.addEventListener("change", function () {
  if (this.checked) {
    comparisonContainer.style.display = "block"; // Show the dropdown when toggle is ON
  } else {
    comparisonContainer.style.display = "none"; // Hide the dropdown when toggle is OFF
  }
});





// Logic for Platform
const platformDropdown = document.getElementById('platform-dropdown');
const platformCustomInput = document.getElementById('platform-custom-input');

platformDropdown.addEventListener('change', function () {
    if (platformDropdown.value === 'custom') {
        //platformDropdown.style.display = 'none';
        platformCustomInput.style.display = 'inline-block';
        platformCustomInput.required = true;
    } else {
        platformDropdown.style.display = 'inline-block';
        platformCustomInput.style.display = 'none';
        platformCustomInput.required = false;
    }
});

// Logic for Library
const libraryDropdown = document.getElementById('library-dropdown');
const libraryCustomInput = document.getElementById('library-custom-input');

libraryDropdown.addEventListener('change', function () {
    if (libraryDropdown.value === 'custom') {
        //libraryDropdown.style.display = 'none';
        libraryCustomInput.style.display = 'inline-block';
        libraryCustomInput.required = true;
    } else {
        libraryDropdown.style.display = 'inline-block';
        libraryCustomInput.style.display = 'none';
        libraryCustomInput.required = false;
    }
});


// Get the annotation dropdown and upload row
const annotationDropdown = document.getElementById('annotation-dropdown');
const annotationUploadRow = document.getElementById('annotation-upload-row');
const referenceDropdown = document.getElementById('reference-dropdown');
const referenceUploadRow = document.getElementById('reference-upload-row');
const dropdown = document.getElementById('organism-dropdown');
const customInput = document.getElementById('organism-custom-input');
const coverageDropdown1 = document.getElementById('coverage-dropdown');
const cageDropdown = document.getElementById('cage-dropdown');
const cageUploadRow = document.getElementById('cage-upload-row');
const quantDropdown = document.getElementById('quant-dropdown');
const quantUploadRow = document.getElementById('quant-upload-row');
const polyADropdown = document.getElementById('poly-A-dropdown');
const polyAUploadRow = document.getElementById('poly-A-upload-row');


let setAnnotationBox2ToCustom = false;

// Add event listener to the Organism dropdown
dropdown.addEventListener('change', function () {
    dropdown.style.color = 'black';

    if (dropdown.value === 'custom') {
        // Show the custom organism input
        customInput.style.display = 'inline-block';
        customInput.required = true;

    } else {
        // Hide the custom organism input
        customInput.style.display = 'none';
        customInput.required = false;
    }
});

// Listen for changes in the organism dropdown
dropdown.addEventListener('change', function() {
    dropdown.style.color = 'black';

    if (dropdown.value === 'custom') {
        customInput.style.display = 'inline-block';
        customInput.required = true;

    } else {
        customInput.style.display = 'none';
        customInput.required = false;
    }
});

// Reference logic
function toggleReferenceInput() {
  if (referenceDropdown.value === 'custom') {
    referenceUploadRow.style.display = 'flex';
  } else {
    referenceUploadRow.style.display = 'none';
  }
}

// Reference logic
function toggleReferenceInput2() {
  const referenceDropdown = document.getElementById('reference-dropdown-2');
  const referenceUploadRow2 = document.getElementById('reference-upload-row-2');

  if (referenceDropdown.value === 'custom') {
    referenceUploadRow2.style.display = 'flex';
  } else {
    referenceUploadRow2.style.display = 'none';
  }
}

function displayReferenceFileName() {
  const fileInput = document.getElementById('reference-upload');
  const fileNameDisplay = document.getElementById('reference-file-name-display');
  if (fileInput.files.length > 0) {
    fileNameDisplay.textContent = fileInput.files[0].name;
    fileNameDisplay.style.color = 'black';
  } else {
    fileNameDisplay.textContent = "No file chosen";
    fileNameDisplay.style.color = '#6c6c6c';
  }
}

function displayReferenceFileName2() {
  const fileInput = document.getElementById('reference-upload-2');
  const fileNameDisplay = document.getElementById('reference-file-name-display-2');
  if (fileInput.files.length > 0) {
    fileNameDisplay.textContent = fileInput.files[0].name;
    fileNameDisplay.style.color = 'black';
  } else {
    fileNameDisplay.textContent = "No file chosen";
    fileNameDisplay.style.color = '#6c6c6c';
  }
}

// Display the selected file name
function displayFileName() {
  const fileInput = document.getElementById('file-upload');
  const fileNameDisplay = document.getElementById('file-name-display');

  if (fileInput.files.length > 0) {
    fileNameDisplay.textContent = fileInput.files[0].name;
    fileNameDisplay.style.color = 'black'; // Change text color to black
  } else {
    fileNameDisplay.textContent = "No file chosen";
    fileNameDisplay.style.color = '#6c6c6c'; // Reset text color to default gray
  }
}

// Display the selected file name
function displayFileName2() {
  const fileInput = document.getElementById('file-upload-2');
  const fileNameDisplay = document.getElementById('file-name-display-2');

  if (fileInput.files.length > 0) {
    fileNameDisplay.textContent = fileInput.files[0].name;
    fileNameDisplay.style.color = 'black'; // Change text color to black
  } else {
    fileNameDisplay.textContent = "No file chosen";
    fileNameDisplay.style.color = '#6c6c6c'; // Reset text color to default gray
  }
}

// Display the selected annotation file name
function displayAnnotationFileName() {
  const fileInput = document.getElementById('annotation-upload');
  const fileNameDisplay = document.getElementById('annotation-file-name-display');

  if (fileInput.files.length > 0) {
    fileNameDisplay.textContent = fileInput.files[0].name;
    fileNameDisplay.style.color = 'black';
  } else {
    fileNameDisplay.textContent = "No file chosen";
    fileNameDisplay.style.color = '#6c6c6c';
  }
}

// Display the selected annotation file name
function displayAnnotationFileName2() {
  const fileInput = document.getElementById('annotation-upload-2');
  const fileNameDisplay = document.getElementById('annotation-file-name-display-2');

  if (fileInput.files.length > 0) {
    fileNameDisplay.textContent = fileInput.files[0].name;
    fileNameDisplay.style.color = 'black';
  } else {
    fileNameDisplay.textContent = "No file chosen";
    fileNameDisplay.style.color = '#6c6c6c';
  }
}

// Toggle the annotation file input based on selection
function toggleAnnotationInput() {
  const annotationDropdown = document.getElementById('annotation-dropdown');
  const annotationUploadRow = document.getElementById('annotation-upload-row');

  if (annotationDropdown.value === 'custom') {
    annotationUploadRow.style.display = 'flex';
  } else {
    annotationUploadRow.style.display = 'none';
  }
}

// Toggle the annotation file input based on selection
function toggleAnnotationInput2() {

  const annotationDropdown = document.getElementById('annotation-dropdown-2');
  const annotationUploadRow = document.getElementById('annotation-upload-row-2');

  if (annotationDropdown.value === 'custom') {
    annotationUploadRow.style.display = 'flex';
  } else {
    annotationUploadRow.style.display = 'none';
  }
}

// Toggle the coverage directory input based on selection
function toggleCoverageInput() {
    const coverageDropdown = document.getElementById('coverage-dropdown');
    const coverageUploadRow = document.getElementById('coverage-upload-row');

    if (coverageDropdown.value === 'custom') {
        coverageUploadRow.style.display = 'flex';
    } else {
        coverageUploadRow.style.display = 'none';
        resetCoverageDirectoryName(); // Reset the directory display
    }
}

// Toggle the coverage directory input based on selection
function toggleCoverageInput2() {
    const coverageDropdown = document.getElementById('coverage-dropdown-2');
    const coverageUploadRow = document.getElementById('coverage-upload-row-2');

    if (coverageDropdown.value === 'custom') {
        coverageUploadRow.style.display = 'flex';
    } else {
        coverageUploadRow.style.display = 'none';
        resetCoverageDirectoryName(); // Reset the directory display
    }
}

// Display the selected directory name(s)
function displayCoverageDirectoryName() {
    const directoryInput = document.getElementById('coverage-upload');
    const directoryNameDisplay = document.getElementById('coverage-directory-name-display');

    if (directoryInput.files.length > 0) {
        const directoryNames = Array.from(directoryInput.files)
            .map(file => file.webkitRelativePath.split('/')[0])
            .filter((value, index, self) => self.indexOf(value) === index); // Get unique directory names

        directoryNameDisplay.textContent = directoryNames.join(', ');
        directoryNameDisplay.style.color = 'black';
    } else {
        resetCoverageDirectoryName();
    }
}

// Display the selected directory name(s)
function displayCoverageDirectoryName2() {
    const directoryInput = document.getElementById('coverage-upload-2');
    const directoryNameDisplay = document.getElementById('coverage-directory-name-display-2');

    if (directoryInput.files.length > 0) {
        const directoryNames = Array.from(directoryInput.files)
            .map(file => file.webkitRelativePath.split('/')[0])
            .filter((value, index, self) => self.indexOf(value) === index); // Get unique directory names

        directoryNameDisplay.textContent = directoryNames.join(', ');
        directoryNameDisplay.style.color = 'black';
    } else {
        resetCoverageDirectoryName();
    }
}

// Reset the coverage directory display
function resetCoverageDirectoryName() {
    const directoryNameDisplay = document.getElementById('coverage-directory-name-display');
    directoryNameDisplay.textContent = "No directory chosen...";
    directoryNameDisplay.style.color = '#6c6c6c';
}

function toggleCageInput() {
  if (cageDropdown.value === 'custom') {
    cageUploadRow.style.display = 'flex';
  } else {
    cageUploadRow.style.display = 'none';
  }
}

const cageDropdown2 = document.getElementById('cage-dropdown2');
const cageUploadRow2 = document.getElementById('cage-upload-row2');
function toggleCageInput2() {
  if (cageDropdown2.value === 'custom') {
    cageUploadRow2.style.display = 'flex';
  } else {
    cageUploadRow2.style.display = 'none';
  }
}

function displayCageFileName() {
  const fileInput = document.getElementById('cage-upload');
  const fileNameDisplay = document.getElementById('cage-file-name-display');
  if (fileInput.files.length > 0) {
    fileNameDisplay.textContent = fileInput.files[0].name;
    fileNameDisplay.style.color = 'black';
  } else {
    fileNameDisplay.textContent = "No file chosen";
    fileNameDisplay.style.color = '#6c6c6c';
  }
}

function displayCageFileName2() {
  const fileInput = document.getElementById('cage-upload2');
  const fileNameDisplay = document.getElementById('cage-file-name-display2');
  if (fileInput.files.length > 0) {
    fileNameDisplay.textContent = fileInput.files[0].name;
    fileNameDisplay.style.color = 'black';
  } else {
    fileNameDisplay.textContent = "No file chosen";
    fileNameDisplay.style.color = '#6c6c6c';
  }
}

function toggleQuantInput() {
  if (quantDropdown.value === 'custom') {
    quantUploadRow.style.display = 'flex';
  } else {
    quantUploadRow.style.display = 'none';
  }
}

const quantDropdown2 = document.getElementById('quant-dropdown2');
const quantUploadRow2 = document.getElementById('quant-upload-row2');
function toggleQuantInput2() {
  if (quantDropdown2.value === 'custom') {
    quantUploadRow2.style.display = 'flex';
  } else {
    quantUploadRow2.style.display = 'none';
  }
}

function displayQuantFileName() {
  const fileInput = document.getElementById('quant-upload');
  const fileNameDisplay = document.getElementById('quant-file-name-display');
  if (fileInput.files.length > 0) {
    fileNameDisplay.textContent = fileInput.files[0].name;
    fileNameDisplay.style.color = 'black';
  } else {
    fileNameDisplay.textContent = "No file chosen";
    fileNameDisplay.style.color = '#6c6c6c';
  }
}

function displayQuantFileName2() {
  const fileInput = document.getElementById('quant-upload2');
  const fileNameDisplay = document.getElementById('quant-file-name-display2');
  if (fileInput.files.length > 0) {
    fileNameDisplay.textContent = fileInput.files[0].name;
    fileNameDisplay.style.color = 'black';
  } else {
    fileNameDisplay.textContent = "No file chosen";
    fileNameDisplay.style.color = '#6c6c6c';
  }
}

function togglePolyAInput() {
  if (polyADropdown.value === 'custom') {
    polyAUploadRow.style.display = 'flex';
  } else {
    polyAUploadRow.style.display = 'none';
  }
}

const polyADropdown2 = document.getElementById('poly-A-dropdown2');
const polyAUploadRow2 = document.getElementById('poly-A-upload-row2');
function togglePolyAInput2() {
  if (polyADropdown.value === 'custom') {
    polyAUploadRow.style.display = 'flex';
  } else {
    polyAUploadRow.style.display = 'none';
  }
}

function displayPolyAFileName() {
  const fileInput = document.getElementById('poly-A-upload');
  const fileNameDisplay = document.getElementById('poly-A-file-name-display');
  if (fileInput.files.length > 0) {
    fileNameDisplay.textContent = fileInput.files[0].name;
    fileNameDisplay.style.color = 'black';
  } else {
    fileNameDisplay.textContent = "No file chosen";
    fileNameDisplay.style.color = '#6c6c6c';
  }
}

function displayPolyAFileName2() {
  const fileInput = document.getElementById('poly-A-upload2');
  const fileNameDisplay = document.getElementById('poly-A-file-name-display2');
  if (fileInput.files.length > 0) {
    fileNameDisplay.textContent = fileInput.files[0].name;
    fileNameDisplay.style.color = 'black';
  } else {
    fileNameDisplay.textContent = "No file chosen";
    fileNameDisplay.style.color = '#6c6c6c';
  }
}


// JavaScript to animate the progress bar and show the overlay
function start_progress(event) {
    event.preventDefault();  // Prevent default form submission

    document.getElementById('overlay').style.display = 'flex';

    // Collect form data
    var formData = new FormData(document.getElementById('script-form'));

    // Add the selected organism to the form data
    // Determine which organism value to use
    const selectedOrganism = dropdown.value;
    if (selectedOrganism === 'custom') {
      // Use custom input value
      formData.set('organism', customInput.value);
    } else {
      // Use the selected organism from dropdown
      formData.set('organism', selectedOrganism);
    }

    const selectedPlatform = platformDropdown.value;
    if (selectedPlatform === 'custom') {
      formData.set('platform', platformCustomInput.value);
    } else {
      formData.append('platform', selectedPlatform);
    }

    const selectedLibrary = libraryDropdown.value;
    if (selectedLibrary === 'custom') {
      formData.set('library_preparation', libraryCustomInput.value);
    } else {
      formData.append('library_preparation', selectedLibrary);
    }

    const toolInputElement = document.getElementById('tool-input');
    const toolName = toolInputElement.value.trim() === '' ? 'your_tool' : toolInputElement.value.trim();
    formData.append('tool', toolName);

    const selectedDataCategory = document.getElementById('data-category-dropdown').value;
    formData.append('data_category', selectedDataCategory);

    // Check if second dataset elements exist (if user clicked + Add Dataset)
    const fileUpload2 = document.getElementById('file-upload-2');
    if (fileUpload2) {
      // If a second file was chosen, append it
      if (fileUpload2.files.length > 0) {
        formData.append('file_2', fileUpload2.files[0]);
      }

      // Handle second platform custom field
      const platformDropdown2 = document.getElementById('platform-dropdown-2');
      const platformCustomInput2 = document.getElementById('platform-custom-input-2');
      if (platformDropdown2.value === 'custom') {
        formData.set('platform_2', platformCustomInput2.value);
      } else {
        formData.set('platform_2', platformDropdown2.value);
      }

      // Handle second library custom field
      const libraryDropdown2 = document.getElementById('library-dropdown-2');
      const libraryCustomInput2 = document.getElementById('library-custom-input-2');
      if (libraryDropdown2.value === 'custom') {
        formData.set('library_preparation_2', libraryCustomInput2.value);
      } else {
        formData.set('library_preparation_2', libraryDropdown2.value);
      }

      const dataCategoryDropdown2 = document.getElementById('data-category-dropdown-2');
      if (dataCategoryDropdown2) {
        const selectedDataCategory2 = dataCategoryDropdown2.value;
        formData.append('data_category_2', selectedDataCategory2);
      }

      // If a second annotation file was chosen, append it
      const annotationInput2 = document.getElementById('annotation-upload-2');
      if (annotationInput2 && annotationInput2.files.length > 0) {
        formData.append('annotation_file_2', annotationInput2.files[0]);
      }
      // And also store the dropdown selection
      const annotationDropdown2 = document.getElementById('annotation-dropdown-2');
      if (annotationDropdown2) {
        formData.append('annotation_2', annotationDropdown2.value);
      }

      // If a second reference file was chosen, append it
      const referenceInput2 = document.getElementById('reference-upload-2');
      if (referenceInput2 && referenceInput2.files.length > 0) {
        formData.append('reference_file_2', referenceInput2.files[0]);
      }
      const referenceDropdown2 = document.getElementById('reference-dropdown-2');
      if (referenceDropdown2) {
        formData.append('reference_2', referenceDropdown2.value);
      }
    }

    // Start the server-side process (Ajax + SSE)
    $.ajax({
        url: "/run_script_challenge1",
        type: "POST",
        data: formData,
        processData: false,  // Prevent jQuery from converting the data
        contentType: false,  // Prevent jQuery from overriding the content type
        success: function(response) {
            console.log(response);

            // Start receiving progress updates via SSE
            const source = new EventSource("/progress_stream");
            source.onmessage = function (event) {
                const data = JSON.parse(event.data);
                const progress = data.progress;
                const message = data.message;

                // Update the progress bar
                document.getElementById("progress-bar").style.width = progress + "%";

                // Update the status message
                document.getElementById("status-message").textContent = message;

                if (progress >= 100) {
                    // Close the SSE connection
                    source.close();
                    // Redirect to the results page
                    window.location.href = "/challenge_results";
                }
            };

            source.onerror = function (event) {
                source.close();
            };
        }
    });
}

let datasetCount = 0; // Keep track of how many additional datasets have been added
let secondDatasetContainer = null; // We'll store a reference to the appended container
let dataset2Box = null; // <-- We'll store the dashed box div here

// Activated process after '+ add dataset'
document.getElementById('add-dataset-button').addEventListener('click', function () {
  datasetCount++;

  document.documentElement.style.setProperty('--multiply-website-height', '30%');

  // Only allow one additional dataset in this example
  if (datasetCount > 1) return;

  // 1) CREATE the dashed box
    dataset2Box = document.createElement('div');
    dataset2Box.className = 'box-dataset2';
  const container = document.getElementById('additional-datasets-container');
  container.appendChild(dataset2Box);

  // Create a container for the new dataset inputs
  secondDatasetContainer = document.createElement('div');
  secondDatasetContainer.className = 'dataset-container';
  secondDatasetContainer.style = "padding: 10px;";

const sirvHTML = document.getElementById('dataset2-sirv-section').innerHTML;
  secondDatasetContainer.innerHTML += sirvHTML;

  container.appendChild(secondDatasetContainer);
  document.getElementById('remove-dataset-button').style.display = 'inline-block';
  document.getElementById('add-dataset-button').style.display = 'none';



  // Append the dataset container to the additional datasets container
  container.appendChild(secondDatasetContainer);

  // Show the 'Remove Dataset' button, hide the '+ Add Dataset' button
  document.getElementById('remove-dataset-button').style.display = 'inline-block';
  document.getElementById('add-dataset-button').style.display = 'none';

  // Logic for Platform
const platformDropdown2 = document.getElementById('platform-dropdown-2');
const platformCustomInput2 = document.getElementById('platform-custom-input-2');

platformDropdown2.addEventListener('change', function () {
    if (platformDropdown2.value === 'custom') {
        //platformDropdown.style.display = 'none';
        platformCustomInput2.style.display = 'inline-block';
        platformCustomInput2.required = true;
    } else {
        platformDropdown2.style.display = 'inline-block';
        platformCustomInput2.style.display = 'none';
        platformCustomInput2.required = false;
    }
});

// Logic for Library Preparation
const libraryDropdown2 = document.getElementById('library-dropdown-2');
const libraryCustomInput2 = document.getElementById('library-custom-input-2');

libraryDropdown2.addEventListener('change', function () {
    if (libraryDropdown2.value === 'custom') {
        //libraryDropdown.style.display = 'none';
        libraryCustomInput2.style.display = 'inline-block';
        libraryCustomInput2.required = true;
    } else {
        libraryDropdown2.style.display = 'inline-block';
        libraryCustomInput2.style.display = 'none';
        libraryCustomInput2.required = false;
    }
});

const cageDropdown2 = document.getElementById('cage-dropdown2')
const cageCustomInput2 = document.getElementById('cage-upload-row2')

cageDropdown2.addEventListener('change', function (){
   if (cageDropdown2.value === 'custom'){
       cageCustomInput2.style.display = 'inline-block';
       cageCustomInput2.required = true;
   } else {
       cageDropdown2.style.display = 'inline-block';
       cageCustomInput2.style.display = 'none';
       cageCustomInput2.required = false;
   }
});

const quantDropdown2 = document.getElementById('quant-dropdown2')
const quantCustomInput2 = document.getElementById('quant-upload-row2')

quantDropdown2.addEventListener('change', function (){
   if (quantDropdown2.value === 'custom'){
       quantCustomInput2.style.display = 'inline-block';
       quantCustomInput2.required = true;
   } else {
       quantDropdown2.style.display = 'inline-block';
       quantCustomInput2.style.display = 'none';
       quantCustomInput2.required = false;
   }
});

const polyADropdown2 = document.getElementById('poly-A-dropdown2')
const polyACustomInput2 = document.getElementById('poly-A-upload-row2')

polyADropdown2.addEventListener('change', function (){
   if (polyADropdown2.value === 'custom'){
       polyACustomInput2.style.display = 'inline-block';
       polyACustomInput2.required = true;
   } else {
       polyADropdown2.style.display = 'inline-block';
       polyACustomInput2.style.display = 'none';
       polyACustomInput2.required = false;
   }
});

updateDropdowns();
});

// Remove Dataset logic
document.getElementById('remove-dataset-button').addEventListener('click', function () {
    // Change --multiply-website-height back to 20%
    document.documentElement.style.setProperty('--multiply-website-height', '0%');
  // If we have actually added a second dataset, remove it
  if (secondDatasetContainer) {
    secondDatasetContainer.remove();
    secondDatasetContainer = null;
  }

  // Remove the dashed box if it exists
    if (dataset2Box) {
      dataset2Box.remove();
      dataset2Box = null;
    }
  datasetCount = 0;

  // Hide the 'Remove Dataset' button, re-show the '+ Add Dataset' button
  document.getElementById('remove-dataset-button').style.display = 'none';
  document.getElementById('add-dataset-button').style.display = 'inline-block';
});

// Comparison dropdown logic
document.getElementById('comparison-dropdown').addEventListener('change', function () {
  const tickableBoxes = document.getElementById('tickable-boxes');
  if (this.value === 'Custom') {
      tickableBoxes.style.display = 'block'; // Show the tickable boxes
  } else {
      tickableBoxes.style.display = 'none'; // Hide the tickable boxes
  }
});

// #################### SIRVs #####################
// Toggle the file input and file name display for each SIRV type
function toggleFileInput(type) {
    // type might be "sirv-2", "ercc-2", "sequin-2", etc.
    const container = document.getElementById(`${type}-file-container`);
    const checkbox  = document.getElementById(`${type}-checkbox`);

    if (!container || !checkbox) {
        console.warn(`Element not found for type: ${type}`);
        return;
    }

    if (checkbox.checked) {
        container.style.display = 'block';
    } else {
        container.style.display = 'none';

        // Clear the file selection when unchecking
        const fileUpload = document.getElementById(`${type}-file-upload`);
        const fileName   = document.getElementById(`${type}-file-name`);
        if (fileUpload && fileName) {
          fileUpload.value = '';
          fileName.textContent = 'No file chosen...';
        }
    }
}



// Display the file name after file selection
function displayFileNameSIRVs(type) {
    // e.g. type = "sirv-2" => looks for "sirv-2-file-upload", "sirv-2-file-name"
    const fileInput       = document.getElementById(`${type}-file-upload`);
    const fileNameDisplay = document.getElementById(`${type}-file-name`);

    if (!fileInput || !fileNameDisplay) {
        console.warn(`File input or display not found for: ${type}`);
        return;
    }

    if (fileInput.files.length > 0) {
        fileNameDisplay.textContent = fileInput.files[0].name;
        fileNameDisplay.style.color = 'black';
    } else {
        fileNameDisplay.textContent = 'No file chosen...';
        fileNameDisplay.style.color = '#6c6c6c';
    }
}



// Grab references to the elements we care about
const lrgaspToggle = document.getElementById("toggleSwitchLRGASP");
const organismDropdown = document.getElementById("organism-dropdown");
const annotationDropdownn = document.getElementById("annotation-dropdown");
const referenceDropdownn = document.getElementById("reference-dropdown");
const coverageDropdown = document.getElementById("coverage-dropdown");
const cageDropdownSwitch = document.getElementById("cage-dropdown");
const quantDropdownSwitch = document.getElementById("quant-dropdown");
const polyADropdownSwitch = document.getElementById("poly-A-dropdown");

// -------------- UPDATE DROPDOWNS LOGIC -------------- //
function updateDropdowns() {

    const annotationDropdown2 = document.getElementById("annotation-dropdown-2");
  const referenceDropdown2 = document.getElementById("reference-dropdown-2");
  const coverageDropdown2  = document.getElementById("coverage-dropdown-2");
    const cageDropdownSwitch2 = document.getElementById("cage-dropdown2");
const quantDropdownSwitch2 = document.getElementById("quant-dropdown2");
const polyADropdownSwitch2 = document.getElementById("poly-A-dropdown2");

  const toggleIsOn = lrgaspToggle.checked;
  const organism   = organismDropdown.value;

  // If user chooses "custom" organism, we forcibly turn OFF the switch
  // and set annotation, reference, coverage to "custom".
  if (organism === "custom") {

    lrgaspToggle.checked = false;
    annotationDropdownn.value = "custom";
    referenceDropdownn.value  = "custom";
    coverageDropdown.value   = "custom";
  }
  else {
    // If the user is NOT choosing custom organism, we check the toggle
    // and the organism to decide how to set annotation, reference, coverage:
    if (toggleIsOn && organism !== 'initial') {
        // ======== Toggle ON ========
        annotationDropdownn.value = "LRGASP_DATA"; // e.g. "LRGASP Data"
        annotationDropdown2.value = "default"; // e.g. "LRGASP Data"
        referenceDropdownn.value = "LRGASP_DATA"; // e.g. "LRGASP Data"
        referenceDropdown2.value = "default"; // e.g. "LRGASP Data"
        coverageDropdown.value = "LRGASP_DATA"; // e.g. "LRGASP Data"
        coverageDropdown2.value = "default"; // e.g. "LRGASP Data"
        cageDropdownSwitch.value = "LRGASP_DATA";
        cageDropdownSwitch2.value = "LRGASP_DATA";
        quantDropdownSwitch.value = "LRGASP_DATA";
        quantDropdownSwitch2.value = "LRGASP_DATA";
        polyADropdownSwitch.value = "LRGASP_DATA";
        polyADropdownSwitch2.value = "LRGASP_DATA";

    }
    else{
        if(organism !== 'initial'){
            // ======== Toggle OFF ========
        annotationDropdownn.value = "custom";
        annotationDropdown2.value = "custom";
        referenceDropdownn.value  = "custom";
        referenceDropdown2.value  = "custom";
        coverageDropdown.value   = "custom";
        coverageDropdown2.value   = "custom";
        cageDropdownSwitch.value = "custom";
        cageDropdownSwitch2.value = "custom";
        quantDropdownSwitch.value = "custom";
        quantDropdownSwitch2.value = "custom";
        polyADropdownSwitch.value = "custom";
        polyADropdownSwitch2.value = "custom";
        }
    }
  }

  // Finally, we must re-check whether we need to show/hide the upload rows
  // based on the new settings:
  toggleAnnotationInput();
  toggleAnnotationInput2();
  toggleReferenceInput();
  toggleReferenceInput2();
  toggleCoverageInput();
  toggleCoverageInput2();
  toggleCageInput();
  toggleQuantInput();
  togglePolyAInput();
  toggleCageInput2();
  toggleQuantInput2();
}

// -------------- EVENT LISTENERS -------------- //

// Whenever user changes the LRGASP toggle:
lrgaspToggle.addEventListener("change", function() {
  updateDropdowns();
});

// Whenever user changes the organism dropdown:
organismDropdown.addEventListener("change", function() {
  updateDropdowns();
});

// Create an EventSource for terminal logs
const terminalLogContainer = document.getElementById("terminal-log-container");
const terminalSource = new EventSource("/terminal_stream");

terminalSource.onmessage = function(event) {
    // Append each new log line to the container
    terminalLogContainer.innerHTML += event.data + "<br>";
    // Auto-scroll to the bottom
    terminalLogContainer.scrollTop = terminalLogContainer.scrollHeight;
};

terminalSource.onerror = function(event) {
    // Optional: close connection on error
    terminalSource.close();
};




</script>

{% endblock %}
</body>
</html>
